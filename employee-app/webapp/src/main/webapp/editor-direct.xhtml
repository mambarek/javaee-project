<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:jsf="http://xmlns.jcp.org/jsf"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:employees="http://xmlns.jcp.org/jsf/composite/employees"
      xmlns:behavior="http://it2go.com/employee">
<h:head>
    <title>Employees App</title>
    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/>
    <link rel="stylesheet" href="bootstrap-4.0.0-alpha.6-dist/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="bootstrap-datepicker-1.6.4-dist/css/bootstrap-datepicker3.css"/>
    <link rel="stylesheet" href="font-awesome-4.7.0/css/font-awesome.min.css"/>
    <link rel="stylesheet" href="assets/css/corporate.css"/>

</h:head>

<h:body>
    <f:view locale="#{webFlowController.locale}" encoding="utf-8">
        <f:loadBundle var="employeeMsg" basename="com.it2go.EmployeeApp"/>
        <f:loadBundle var="messages" basename="com.it2go.Messages"/>
    </f:view>

    <header>
        <nav class="navbar navbar-light bg-faded rounded navbar-toggleable-md hidden-md-down">
            <div class="container">
                <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#m1" aria-controls="m1" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"/>
                </button>
                <a class="navbar-brand" href="#">
                    <img src="themes/theme_blue/corp_logo.jpg" class="img-fluid" style="width: 150px"/>
                </a>

                <div  class="collapse navbar-collapse" id="m1">
                    <ul class="navbar-nav mr-auto">
                        <li class="nav-item active">
                            <a class="nav-link" href="#">Home <span class="sr-only">(current)</span></a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#">Link</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link disabled" href="#">Disabled</a>
                        </li>

                    </ul>
                    <form class="form-inline my-2 my-lg-0">
                        <input class="form-control mr-sm-2" type="text" placeholder="#{employeeMsg['employee.header.menu.search']}"/>
                        <button class="btn btn-primary my-2 my-sm-0" type="submit">#{employeeMsg['employee.header.menu.search']}</button>
                    </form>
                    <div class="pull-right ml-3">
                        <div class="btn-group">
                            <button type="button" class="btn btn-primary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                #{employeeMsg['employee.app.language']} (#{webFlowController.locale})
                            </button>
                            <div class="dropdown-menu">
                                <form jsf:id="manu_links_xx">
                                    <a jsf:id="en" class="dropdown-item" jsf:action="#{webFlowController.changeLocal('en','employeeList')}">#{employeeMsg['employee.app.language.englisch']}</a>
                                    <a jsf:id="de" class="dropdown-item" jsf:action="#{webFlowController.changeLocal('de','employeeList')}">#{employeeMsg['employee.app.language.german']}</a>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </nav>

        <div class="container">

        </div>
        <nav class="navbar navbar-toggleable-md navbar-inverse bg-inverse">
            <div class="container">
                <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#m2" aria-controls="m2" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"/>
                </button>
                <a class="navbar-brand" href="#">E-Management</a>

                <div class="collapse navbar-collapse" id="m2">
                    <ul class="navbar-nav mr-auto">
                        <li class="nav-item active">
                            <a class="nav-link" href="#">Home <span class="sr-only">(current)</span></a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#">Link</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link disabled" href="#">Disabled</a>
                        </li>
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="http://example.com" id="dropdown04" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Dropdown</a>
                            <div class="dropdown-menu" aria-labelledby="dropdown04">
                                <a class="dropdown-item" href="#">Action</a>
                                <a class="dropdown-item" href="#">Another action</a>
                                <a class="dropdown-item" href="#">Something else here</a>
                            </div>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>
    </header>

    <div class="container-fluid">
        <div class="row hidden-md-down">
            <div class="col-lg-3"/>
            <div class="col">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="#">Home</a></li>
                    <li class="breadcrumb-item"><a href="#">Library</a></li>
                    <li class="breadcrumb-item active">Data</li>
                </ol>
            </div>
        </div>

        <div class="row ">
            <div class="col-lg-1"/>
            <div class="col-lg-2">
                <div class="card">
                    <div class="card-header corp-block-header-left">
                        Aktionen
                    </div>
                    <ul class="nav flex-column">
                        <li class="nav-item">
                            <a class="nav-link active" href="#">Active</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#">Link</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#">Link</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link disabled" href="#">Disabled</a>
                        </li>
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="http://example.com" id="dropdown-left" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Dropdown</a>
                            <div class="dropdown-menu" aria-labelledby="dropdown-left">
                                <a class="dropdown-item" href="#">Action</a>
                                <a class="dropdown-item" href="#">Another action</a>
                                <a class="dropdown-item" href="#">Something else here</a>
                            </div>
                        </li>
                        <li class="nav-item">
                            <a href="#" data-toggle="collapse" data-target="#toggleDemo" class="nav-link collapsed">
                                Submenu
                            </a>
                            <div class="collapse" id="toggleDemo" style="height: 0px;">
                                <ul class="nav flex-column">
                                    <li class="nav-item"><a class="nav-link" href="#">Submenu 1</a></li>
                                    <li class="nav-item"><a class="nav-link" href="#">Submenu 2</a></li>
                                    <li class="nav-item"><a class="nav-link" href="#">Submenu 3</a></li>
                                </ul>
                            </div>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="col-md-12 col-lg-6" jsf:id="content">
                <div class="card">
                    <div class="card-header corp-block-header">
                        Angestelltenliste
                    </div>
                    <div class="card-block" style="padding: 0px">
                        <div class="table-responsive mb-5">
                            <table jsf:id="employeeList" class="table table-hover table-sm">
                            <thead  class="table-header">
                            <tr>
                                <th scope="col">#{employeeMsg['employee.table.col.details']}</th>
                                <th scope="col">#{employeeMsg['employee.table.col.firstName']}</th>
                                <th scope="col">#{employeeMsg['employee.table.col.lastName']}</th>
                                <th scope="col">#{employeeMsg['employee.table.col.salary']}</th>
                                <th scope="col">#{employeeMsg['employee.table.col.birthDate']}</th>
                            </tr>
                            </thead>
                            <tbody>
                            <ui:repeat var="employee" value="#{employeeListController.allEmployees}">
                                <tr>
                                    <td>
                                        <form jsf:id="id_link">
                                            <a href="#" jsf:id="edit"
                                               >
                                                <i class="fa fa-pencil-square-o" aria-hidden="true"/></a>
                                            <f:ajax execute="@this" render="editorWrapper" listener="#{editEmployeeController.editEmployeeAjax(employee.id)}" event="click"/>
                                        </form>
                                    </td>
                                    <td>
                                        <form jsf:id="firstName_link">
                                            <a jsf:id="edit"
                                               jsf:action="#{employeeListController.editEmployeeOnNewPage(employee.id)}">#{employee.firstName}</a>
                                        </form>
                                    </td>
                                    <td><a jsf:id="lastName_link"
                                           jsf:outcome="editEmployee?id=#{employee.id}">#{employee.lastName}</a></td>
                                    <td><label jsf:value="#{employee.salary}"><f:convertNumber currencySymbol="$" minFractionDigits="2"/></label></td>
                                    <td><label jsf:id="table_birthdate" jsf:value="#{employee.birthDate}"><f:convertDateTime pattern="#{employeeMsg['employee.app.date.pattern']}"/></label></td>
                                </tr>
                            </ui:repeat>
                            </tbody>
                            </table>
                        </div>
                     </div>
                    <div class="card-footer">
                        <h:form id="create_employee_form">
                            <input type="submit" value="Anlegen" jsf:id="create_button" jsf:action="#{editEmployeeController.editEmployeeAjax(null)}">
                                <f:ajax execute="@form" render=":editorWrapper" />
                            </input>
                            <button type="submit" value="Button" jsf:id="submit">
                                Button
                                <f:ajax render=":editorWrapper" />
                            </button>

                            <h:commandButton action="#{editEmployeeController.editEmployeeAjax(null)}" value="Anlegen commandButton">
                                <f:ajax render=":editorWrapper"/>
                            </h:commandButton>
                        </h:form>
                    </div>
                </div>

                <div jsf:id="editorWrapper">
                    <ui:fragment rendered="#{!empty editEmployeeController.model}">
                        <div class="card" >
                            <div class="card-header corp-block-form-header">
                                #{employeeMsg['employee.editor.title']}
                            </div>
                            <div class="card-block">
                                <form jsf:id="employeeForm" class="form-horizontal employeeForm" >
                                    <div class="form-row">

                                        <div class="form-group row ">
                                            <label class="col-form-label col-md-3" for="firstName">#{employeeMsg['employee.editor.firstName']}</label>
                                            <div class="col">
                                                <input type="text" class="form-control" jsf:id="firstName" jsf:required="true"
                                                       jsf:value="#{editEmployeeController.model.firstName}" data-valid="#{component.valid}">
                                                    <f:validateLength minimum="3" maximum="50"/>
                                                    <!--<f:ajax execute="@this" render="@this" onevent="handleAjax" event="change"/>-->
                                                </input>
                                                <h:message for="firstName" errorClass="form-control-feedback" />
                                            </div>
                                        </div>
                                        <div class="form-group row">
                                            <label class="col-md-3 col-form-label" for="lastName">#{employeeMsg['employee.editor.lastName']}</label>
                                            <div class="col">
                                                <input type="text" class="form-control" jsf:id="lastName" jsf:required="true"
                                                       jsf:value="#{editEmployeeController.model.lastName}" data-valid="#{component.valid}">
                                                    <f:validateLength minimum="3" maximum="50"/>
                                                    <!--<f:ajax execute="@this" render="@this" onevent="handleAjax"/>-->
                                                </input>
                                                <h:message for="lastName" errorClass="form-control-feedback"/>
                                            </div>
                                        </div>
                                        <div class="form-group row">
                                            <label class="col-md-3 col-form-label" for="birthDate">#{employeeMsg['employee.editor.birthDate']}</label>
                                            <div class="col">
                                                <div class="input-group date" data-provide="datepicker" data-date-autoClose="true"  >
                                                    <input type="text" class="form-control" jsf:id="birthDate"
                                                           jsf:value="#{editEmployeeController.model.birthDate}"  data-valid="#{component.valid}">
                                                        <f:convertDateTime pattern="#{employeeMsg['employee.app.date.pattern']}"/>
                                                        <!--<f:ajax execute="@this" render="@this" onevent="handleAjax"/>-->
                                                    </input>
                                                    <div class="input-group-addon">
                                                        <i class="fa fa-calendar" aria-hidden="true"/>
                                                    </div>
                                                </div>
                                                <h:message for="birthDate" errorClass="form-control-feedback" />
                                            </div>
                                        </div>

                                        <employees:emailList value="#{editEmployeeController.model.emails}"/>

                                        <div class="form-group row">
                                            <label class="col-md-3 col-form-label" for="salary">#{employeeMsg['employee.editor.salary']}</label>
                                            <div class="col">
                                                <input type="text" class="form-control" jsf:id="salary"  data-valid="#{component.valid}"
                                                       jsf:value="#{editEmployeeController.model.salary}">
                                                    <f:convertNumber currencySymbol="EUR" minFractionDigits="2" type="currency"/>
                                                    <!--<f:ajax execute="@this" render="@this" onevent="handleAjax"/>-->
                                                </input>
                                                <h:message errorClass="form-control-feedback" id="errors1" for="salary"/>
                                            </div>
                                        </div>

                                        <div class="form-group row justify-content-end hidden-sm-down">
                                            <div class="btn-group">
                                                <button type="submit" class="btn btn-primary mr-2" jsf:immediate="true" jsf:id="cancel">
                                                    #{employeeMsg['employee.editor.button.cancel']}</button>

                                                <button class="btn btn-primary mr-2" jsf:rendered="#{editEmployeeController.model.isNew() == false}"
                                                        jsf:id="delete">
                                                    <!--First ask for confirmation -->
                                                    <behavior:confirm modalSelector="#myModal" message="Möchten Sie den Datensatz wirklich löschen?"
                                                                      ajax="true" successJsFunction="function(){$('#hiddenForm\\:hdnBtn').click();}"/>
                                                    <i class="fa fa-trash-o" aria-hidden="true"/> #{employeeMsg['employee.editor.button.delete']}
                                                </button>

                                                <button class="btn btn-primary mr-3" jsf:id="save" jsf:action="#{editEmployeeController.saveEmployee()}">
                                                   #{employeeMsg['employee.editor.button.save']}
                                                </button>

                                                <h:commandButton action="#{editEmployeeController.saveEmployee()}"   value="Command">
                                                    <f:ajax execute="@form" render="@form" />
                                                </h:commandButton>
                                            </div>
                                        </div>

                                    </div>
                                </form>

                            </div>
                        </div>

                        <!-- hidden form for confirmation dialog action delete-->
                        <h:form id="hiddenForm">
                            <h:commandButton id="hdnBtn" actionListener="#{editEmployeeController.deleteEmployee}"
                                             style="display: none;"/>
                        </h:form>

                        <div class="modal fade" id="myModal">
                            <div class="modal-dialog" role="document">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <h5 class="modal-title">Löschen</h5>
                                    </div>
                                    <div class="modal-body">
                                        <p class="modal-message">Möchten Sie den Datensatz wirklich löschen?</p>
                                    </div>
                                    <div class="modal-footer">
                                        <button id="modal-ok" type="button" class="btn btn-primary" >Löschen</button>
                                        <button id="modal-cancel" type="button" class="btn btn-secondary" data-dismiss="modal">Abbrechen</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </ui:fragment>
                </div>
            </div>
            <div class="col-md-12 col-lg-2">
                <div class="card mb-3">
                    <div class="card-header corp-block-header-reight">
                        Informationen
                    </div>

                    <div class="card-body">

                        <p class="card-text">With supporting text below as a natural lead-in to additional content.</p>
                        <h:messages style="color: red;"/>
                    </div>
                </div>

            </div>
            <div class="col-lg-1"/>
        </div>

        <hr/>

        <footer>
            <!-- Example row of columns -->
            <div class="row corp-footer mt-3">
                <div class="col-lg-4 p-5">
                    <h2>Heading 1</h2>
                    <p>Donec id elit non mi porta gravida at eget metus. Fusce dapibus, tellus ac cursus commodo, tortor mauris condimentum nibh, ut fermentum massa justo sit amet risus. Etiam porta sem malesuada magna mollis euismod. Donec sed odio dui. </p>
                    <p><a class="btn btn-primary" href="#" role="button">View details &#187;</a></p>
                </div>
                <div class="col-lg-4 p-5">
                    <h2>Heading 2</h2>
                    <p>Donec id elit non mi porta gravida at eget metus. Fusce dapibus, tellus ac cursus commodo, tortor mauris condimentum nibh, ut fermentum massa justo sit amet risus. Etiam porta sem malesuada magna mollis euismod. Donec sed odio dui. </p>
                    <p><a class="btn btn-primary" href="#" role="button">View details &#187;</a></p>
                </div>
                <div class="col-lg-4 p-5">
                    <h2>Heading 3</h2>
                    <p>Donec sed odio dui. Cras justo odio, dapibus ac facilisis in, egestas eget quam. Vestibulum id ligula porta felis euismod semper. Fusce dapibus, tellus ac cursus commodo, tortor mauris condimentum nibh, ut fermentum massa.</p>
                    <p><a class="btn btn-primary" href="#" role="button">View details &#187;</a></p>
                </div>
            </div>
        </footer>
        </div> <!-- /Container-->
    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"/>
    <!--<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.3/umd/popper.min.js"/>-->
    <script src="bootstrap-4.0.0-beta.3-dist/js/bootstrap.bundle.js"/>
    <script src="bootstrap-datepicker-1.6.4-dist/js/bootstrap-datepicker.min.js"/>
    <script src="bootstrap-datepicker-1.6.4-dist/locales/bootstrap-datepicker.de.min.js"  charset="UTF-8"/>
<!--    <script type="text/javascript">
        $(document).ready(function() {
            $('.date').datepicker({
                language: '#{webFlowController.locale}',
                autoClose: true,
                todayHighlight: true,
                format: "#{employeeMsg['employee.app.javascript.date.pattern']}"
            })
        });
    </script>-->
    <script src="assets/js/employee.js"/>
    <script src="assets/js/jsf-fixes.js"/>
</h:body>
</html>