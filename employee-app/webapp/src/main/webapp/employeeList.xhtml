<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:jsf="http://xmlns.jcp.org/jsf"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:empl="http://xmlns.it2go.com/jsf/employee"
      xmlns:employees="http://xmlns.jcp.org/jsf/composite/employees">
<h:head>
    <title>Employees App</title>
    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/>
    <link rel="stylesheet" href="bootstrap-4.0.0-alpha.6-dist/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="bootstrap-datepicker-1.6.4-dist/css/bootstrap-datepicker3.css"/>
    <link rel="stylesheet" href="font-awesome-4.7.0/css/font-awesome.min.css"/>
    <link rel="stylesheet" href="assets/css/corporate.css"/>
    <link rel="stylesheet" href="assets/css/loader.css" />
</h:head>

<h:body>
    <f:view locale="#{webFlowController.locale}" encoding="utf-8">
        <f:loadBundle var="employeeMsg" basename="com.it2go.EmployeeApp"/>
        <f:loadBundle var="messages" basename="com.it2go.Messages"/>
    </f:view>

    <header>
        <nav class="navbar navbar-light bg-faded rounded navbar-toggleable-md hidden-md-down">
            <div class="container">
                <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#m1" aria-controls="m1" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"/>
                </button>
                <a class="navbar-brand" href="#">
                    <img src="themes/theme_blue/corp_logo.jpg" class="img-fluid" style="width: 150px"/>
                </a>

                <div  class="collapse navbar-collapse" id="m1">
                    <ul class="navbar-nav mr-auto">
                        <li class="nav-item active">
                            <a class="nav-link" href="#">Home <span class="sr-only">(current)</span></a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#">Link</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link disabled" href="#">Disabled</a>
                        </li>

                    </ul>
                    <form class="form-inline my-2 my-lg-0">
                        <input class="form-control mr-sm-2" type="text" placeholder="#{employeeMsg['employee.header.menu.search']}"/>
                        <button class="btn btn-primary my-2 my-sm-0" type="submit">#{employeeMsg['employee.header.menu.search']}</button>
                    </form>
                    <div class="pull-right ml-3">
                        <div class="btn-group">
                            <button type="button" class="btn btn-primary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                #{employeeMsg['employee.app.language']} (#{webFlowController.locale})
                            </button>
                            <div class="dropdown-menu">
                                <form jsf:id="manu_links_xx">
                                    <a jsf:id="en" class="dropdown-item" jsf:action="#{webFlowController.changeLocal('en','employeeList')}">#{employeeMsg['employee.app.language.englisch']}</a>
                                    <a jsf:id="de" class="dropdown-item" jsf:action="#{webFlowController.changeLocal('de','employeeList')}">#{employeeMsg['employee.app.language.german']}</a>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </nav>

        <div class="container">

        </div>
        <nav class="navbar navbar-toggleable-md navbar-inverse bg-inverse">
            <div class="container">
                <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#m2" aria-controls="m2" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"/>
                </button>
                <a class="navbar-brand" href="#">E-Management</a>

                <div class="collapse navbar-collapse" id="m2">
                    <ul class="navbar-nav mr-auto">
                        <li class="nav-item active">
                            <a class="nav-link" href="#">Home <span class="sr-only">(current)</span></a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#">Link</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link disabled" href="#">Disabled</a>
                        </li>
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="http://example.com" id="dropdown04" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Dropdown</a>
                            <div class="dropdown-menu" aria-labelledby="dropdown04">
                                <a class="dropdown-item" href="#">Action</a>
                                <a class="dropdown-item" href="#">Another action</a>
                                <a class="dropdown-item" href="#">Something else here</a>
                            </div>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>
    </header>

    <div class="container-fluid">
        <div class="row hidden-md-down">
            <div class="col-lg-3"/>
            <div class="col">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="#">Home</a></li>
                    <li class="breadcrumb-item"><a href="#">Library</a></li>
                    <li class="breadcrumb-item active">Data</li>
                </ol>
            </div>
        </div>

        <div class="row ">
            <div class="col-lg-1"/>
            <div class="col-lg-2">
                <div class="card">
                    <div class="card-header corp-block-header-left">
                        Aktionen
                    </div>
                    <ul class="nav flex-column">
                        <li class="nav-item">
                            <a class="nav-link active" href="#">Active</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#">Link</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#">Link</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link disabled" href="#">Disabled</a>
                        </li>
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="http://example.com" id="dropdown-left" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Dropdown</a>
                            <div class="dropdown-menu" aria-labelledby="dropdown-left">
                                <a class="dropdown-item" href="#">Action</a>
                                <a class="dropdown-item" href="#">Another action</a>
                                <a class="dropdown-item" href="#">Something else here</a>
                            </div>
                        </li>
                        <li class="nav-item">
                            <a href="#" data-toggle="collapse" data-target="#toggleDemo" class="nav-link collapsed">
                                Submenu
                            </a>
                            <div class="collapse" id="toggleDemo" style="height: 0px;">
                                <ul class="nav flex-column">
                                    <li class="nav-item"><a class="nav-link" href="#">Submenu 1</a></li>
                                    <li class="nav-item"><a class="nav-link" href="#">Submenu 2</a></li>
                                    <li class="nav-item"><a class="nav-link" href="#">Submenu 3</a></li>
                                </ul>
                            </div>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="col-md-12 col-lg-6" jsf:id="content">
                <div class="card" >
                    <div class="card-header corp-block-header">
                        Angestelltenliste
                    </div>
                    <div class="card-block" style="padding: 0px">
                        <div class="table-responsive mb-5">
                            <table jsf:id="employeeList" class="table table-hover table-sm">
                            <thead  class="table-header">
                            <tr>
                                <th scope="col">#{employeeMsg['employee.table.col.details']}</th>
                                <th scope="col">#{employeeMsg['employee.table.col.firstName']}</th>
                                <th scope="col">#{employeeMsg['employee.table.col.lastName']}</th>
                                <th scope="col">#{employeeMsg['employee.table.col.salary']}</th>
                                <th scope="col">#{employeeMsg['employee.table.col.birthDate']}</th>
                            </tr>
                            </thead>
                            <tbody>
                            <ui:repeat var="employee" value="#{employeeListController.allEmployees}">
                                <tr>
                                    <td>
                                        <form jsf:id="id_link">
                                            <a href="#" jsf:id="edit"
                                               >
                                                <i class="fa fa-pencil-square-o" aria-hidden="true"/></a>
                                            <f:ajax execute="@this" render="content"
                                                    listener="#{editEmployeeController.editEmployeeAjax(employee.id)}"
                                                    event="click"
                                            />
                                        </form>
                                    </td>
                                    <td>
                                        <form jsf:id="firstName_link">
                                            <a jsf:id="edit"
                                               jsf:action="#{employeeListController.editEmployeeOnNewPage(employee.id)}">#{employee.firstName}</a>
                                        </form>
                                    </td>
                                    <td><a jsf:id="lastName_link"
                                           jsf:outcome="editEmployee?id=#{employee.id}">#{employee.lastName}</a></td>
                                    <td><label jsf:value="#{employee.salary}"><f:convertNumber currencySymbol="$" minFractionDigits="2"/></label></td>
                                    <td><label jsf:id="table_birthdate" jsf:value="#{employee.birthDate}"><f:convertDateTime pattern="#{employeeMsg['employee.app.date.pattern']}"/></label></td>
                                </tr>
                            </ui:repeat>
                            </tbody>
                            </table>
                        </div>
                     </div>
                    <div class="card-footer">
                        <h:form id="create_employee_form" rendered="#{empty editEmployeeController.model}">
                            <input type="submit" value="Anlegen" jsf:id="create_button">
                                <f:ajax listener="#{editEmployeeController.createNewEmployee()}" render=":content"/>
                            </input>
                        </h:form>
                    </div>
                </div>

                <div jsf:id="editorWrapper">

                    <employees:employeeEditor model="#{editEmployeeController.model}" renderAfterSave="content"
                                              rendered="#{!empty editEmployeeController.model}"
                                              deleteConfirmFunc="function(){$('#hiddenForm\\:deleteBtn').click();}"
                                              saveConfirmFunc="function(){$('#hiddenForm\\:saveBtn').click();}">
                        <f:ajax event="cancel" listener="#{editEmployeeController.cancel()}" render="content"/>
                        <f:ajax event="saveConfirmed" render="content" onevent="handleAjaxSaveEvent" listener="#{editEmployeeController.ajaxSaveAction}"/>
                        <f:actionListener for="saveConfirmedBtn" binding="#{EditEmployeeEditorActionListener}"/>
                        <!--<f:actionListener for="saveButton" binding="#{editEmployeeController.saveEmployee()}"/>-->
                        <!-- WICHTIG: an dieser stelle kein AJAX für den save button. submitt fuktioniert dann nicht mehr-->
                    </employees:employeeEditor>

                    <!-- hidden form for confirmation dialog action delete-->
                    <h:form id="hiddenForm" style="display: none;">
                        <h:commandButton id="saveBtn" actionListener="#{editEmployeeController.saveEmployee}">
                            <f:ajax execute="@this" render="content"/>
                        </h:commandButton>
                        <h:commandButton id="deleteBtn" actionListener="#{editEmployeeController.deleteEmployee}">
                            <f:ajax execute="@this" render="content" onevent="checkValidation"/>
                        </h:commandButton>
                    </h:form>
                </div>
            </div>
            <div class="col-md-12 col-lg-2">
                <div class="card mb-3">
                    <div class="card-header corp-block-header-reight">
                        Informationen
                    </div>

                    <div class="card-body">

                        <p class="card-text">With supporting text below as a natural lead-in to additional content.</p>
                        <h:messages style="color: red;"/>
                    </div>
                </div>

            </div>
            <div class="col-lg-1"/>
        </div>

        <hr/>

        <footer>
            <!-- Example row of columns -->
            <div class="row corp-footer mt-3">
                <div class="col-lg-4 p-5">
                    <h2>Heading 1</h2>
                    <p>Donec id elit non mi porta gravida at eget metus. Fusce dapibus, tellus ac cursus commodo, tortor mauris condimentum nibh, ut fermentum massa justo sit amet risus. Etiam porta sem malesuada magna mollis euismod. Donec sed odio dui. </p>
                    <p><a class="btn btn-primary" href="#" role="button">View details &#187;</a></p>
                </div>
                <div class="col-lg-4 p-5">
                    <h2>Heading 2</h2>
                    <p>Donec id elit non mi porta gravida at eget metus. Fusce dapibus, tellus ac cursus commodo, tortor mauris condimentum nibh, ut fermentum massa justo sit amet risus. Etiam porta sem malesuada magna mollis euismod. Donec sed odio dui. </p>
                    <p><a class="btn btn-primary" href="#" role="button">View details &#187;</a></p>
                </div>
                <div class="col-lg-4 p-5">
                    <h2>Heading 3</h2>
                    <p>Donec sed odio dui. Cras justo odio, dapibus ac facilisis in, egestas eget quam. Vestibulum id ligula porta felis euismod semper. Fusce dapibus, tellus ac cursus commodo, tortor mauris condimentum nibh, ut fermentum massa.</p>
                    <p><a class="btn btn-primary" href="#" role="button">View details &#187;</a></p>
                </div>
            </div>
        </footer>
        </div> <!-- /Container-->
    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"/>
    <!--<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.3/umd/popper.min.js"/>-->
    <script src="bootstrap-4.0.0-beta.3-dist/js/bootstrap.bundle.js"/>
    <script src="bootstrap-datepicker-1.6.4-dist/js/bootstrap-datepicker.min.js"/>
    <script src="bootstrap-datepicker-1.6.4-dist/locales/bootstrap-datepicker.de.min.js"  charset="UTF-8"/>

    <script src="assets/js/employee.js"/>
    <script src="assets/js/jsf-fixes.js"/>
    <script src="assets/js/loader.js"/>
    <script src="assets/js/empoyee-i18n.js"/>
    <h:outputScript>
        employee_i18n.cancel = '#{employeeMsg['employee.overlay.cancel']}';
        employee_i18n.save = '#{employeeMsg['employee.overlay.save']}';
        employee_i18n.deleteData = '#{employeeMsg['employee.overlay.deleteData']}';
        employee_i18n.deleteDataQuestion = '#{employeeMsg['employee.overlay.deleteDataQuestion']}';
        employee_i18n.error = '#{employeeMsg['employee.overlay.error']}';
        employee_i18n.info = '#{employeeMsg['employee.overlay.info']}';
        employee_i18n.no = '#{employeeMsg['employee.overlay.no']}';
        employee_i18n.ok = '#{employeeMsg['employee.overlay.ok']}';
        employee_i18n.warning = '#{employeeMsg['employee.overlay.warning']}';
        employee_i18n.saveData = '#{employeeMsg['employee.overlay.saveData']}';
        employee_i18n.saveDataQuestion = '#{employeeMsg['employee.overlay.saveDataQuestion']}';
        employee_i18n.yes = '#{employeeMsg['employee.overlay.yes']}';
        employee_i18n.deleteDataWaitMessage = '#{employeeMsg['employee.overlay.deleteDataWaitMessage']}';
        employee_i18n.saveDataWaitMessage = '#{employeeMsg['employee.overlay.saveDataWaitMessage']}';
        employee_i18n.savingSuccess = '#{employeeMsg['employee.overlay.savingSuccess']}';
        employee_i18n.deletingSuccess = '#{employeeMsg['employee.overlay.deletingSuccess']}';
    </h:outputScript>
</h:body>
</html>